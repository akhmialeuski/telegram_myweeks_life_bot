============================= test session starts ==============================
platform linux -- Python 3.12.3, pytest-7.4.3, pluggy-1.6.0 -- /mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/.venv/bin/python
cachedir: .pytest_cache
rootdir: /mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot
configfile: pyproject.toml
plugins: anyio-4.10.0, asyncio-0.21.1, cov-4.1.0, mock-3.11.1
asyncio: mode=Mode.STRICT
collecting ... collected 622 items

tests/test_bot/test_application.py::TestHandlers::test_handlers_mapping_contains_all_commands PASSED [  0%]
tests/test_bot/test_application.py::TestHandlers::test_handlers_have_correct_structure PASSED [  0%]
tests/test_bot/test_application.py::TestHandlers::test_text_input_handlers_have_waiting_states PASSED [  0%]
tests/test_bot/test_application.py::TestLifeWeeksBot::test_init_default_state PASSED [  0%]
tests/test_bot/test_application.py::TestLifeWeeksBot::test_setup_logic PASSED [  0%]
tests/test_bot/test_application.py::TestLifeWeeksBot::test_register_handlers_registers_all_types PASSED [  0%]
tests/test_bot/test_application.py::TestLifeWeeksBot::test_setup_does_not_reinitialize PASSED [  1%]
tests/test_bot/test_application.py::TestLifeWeeksBot::test_setup_scheduler_handles_error_gracefully PASSED [  1%]
tests/test_bot/test_application.py::TestLifeWeeksBot::test_start_calls_setup_if_not_initialized PASSED [  1%]
tests/test_bot/test_application.py::TestLifeWeeksBot::test_start_runs_polling_and_scheduler PASSED [  1%]
tests/test_bot/test_application.py::TestLifeWeeksBot::test_stop_cleans_up_scheduler PASSED [  1%]
tests/test_bot/test_application.py::TestLifeWeeksBot::test_universal_text_handler_routes_correctly PASSED [  1%]
tests/test_bot/test_application.py::TestLifeWeeksBot::test_setup_scheduler_assigns_instance PASSED [  2%]
tests/test_bot/test_application.py::TestLifeWeeksBot::test_register_handlers_with_message_handler FAILED [  2%]
tests/test_bot/test_base_handler.py::TestBaseHandler::test_init_default_values PASSED [  2%]
tests/test_bot/test_base_handler.py::TestBaseHandler::test_should_require_registration_with_no_command_name PASSED [  2%]
tests/test_bot/test_base_handler.py::TestBaseHandler::test_should_require_registration_with_no_registration_command PASSED [  2%]
tests/test_bot/test_base_handler.py::TestBaseHandler::test_should_require_registration_with_protected_command PASSED [  2%]
tests/test_bot/test_base_handler.py::TestBaseHandler::test_wrap_with_registration_no_registration_required PASSED [  3%]
tests/test_bot/test_base_handler.py::TestBaseHandler::test_edit_message PASSED [  3%]
tests/test_bot/test_base_handler.py::TestBaseHandler::test_edit_message_without_markup PASSED [  3%]
tests/test_bot/test_base_handler.py::TestBaseHandler::test_extract_command_context PASSED [  3%]
tests/test_bot/test_cancel_handler.py::TestCancelHandler::test_handler_creation PASSED [  3%]
tests/test_bot/test_cancel_handler.py::TestCancelHandler::test_handle_success PASSED [  3%]
tests/test_bot/test_cancel_handler.py::TestCancelHandler::test_handle_deletion_error PASSED [  4%]
tests/test_bot/test_cancel_handler.py::TestCancelHandler::test_handle_service_error PASSED [  4%]
tests/test_bot/test_cancel_handler.py::TestCancelHandler::test_handle_scheduler_removal_failure PASSED [  4%]
tests/test_bot/test_help_handler.py::TestHelpHandler::test_handler_creation PASSED [  4%]
tests/test_bot/test_help_handler.py::TestHelpHandler::test_handle_success PASSED [  4%]
tests/test_bot/test_scheduler.py::TestSendWeeklyMessageToUser::test_sends_message_if_user_found PASSED [  4%]
tests/test_bot/test_scheduler.py::TestSendWeeklyMessageToUser::test_logs_warning_if_user_not_found PASSED [  4%]
tests/test_bot/test_scheduler.py::TestSendWeeklyMessageToUser::test_logs_error_on_exception PASSED [  5%]
tests/test_bot/test_scheduler.py::TestCreateUserNotificationJob::test_creates_job_if_settings_are_valid PASSED [  5%]
tests/test_bot/test_scheduler.py::TestCreateUserNotificationJob::test_raises_exception_if_settings_are_missing PASSED [  5%]
tests/test_bot/test_scheduler.py::TestCreateUserNotificationJob::test_returns_none_if_notifications_disabled PASSED [  5%]
tests/test_bot/test_scheduler.py::TestCreateUserNotificationJob::test_raises_exception_if_settings_are_incomplete[missing_day] PASSED [  5%]
tests/test_bot/test_scheduler.py::TestCreateUserNotificationJob::test_raises_exception_if_settings_are_incomplete[missing_time] PASSED [  5%]
tests/test_bot/test_scheduler.py::TestCreateUserNotificationJob::test_raises_exception_if_settings_are_incomplete[missing_both] PASSED [  6%]
tests/test_bot/test_scheduler.py::TestCreateUserNotificationJob::test_raises_exception_on_job_creation_exception PASSED [  6%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_add_user_success PASSED [  6%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_add_user_raises_exception_if_job_creation_fails PASSED [  6%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_add_user_raises_exception_on_exception PASSED [  6%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_add_user_raises_exception_when_user_not_found PASSED [  6%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_remove_user_success PASSED [  7%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_remove_user_handles_nonexistent_job PASSED [  7%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_remove_user_logger_error_handling PASSED [  7%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_remove_user_handles_job_lookup_error PASSED [  7%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_update_user_success PASSED [  7%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_update_user_handles_nonexistent_job PASSED [  7%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_update_user_raises_if_user_not_found PASSED [  8%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_update_user_raises_if_job_creation_fails PASSED [  8%]
tests/test_bot/test_scheduler.py::TestSchedulerManagementFunctions::test_update_user_raises_on_exception PASSED [  8%]
tests/test_bot/test_scheduler.py::TestSetupUserNotificationSchedules::test_schedules_jobs_for_all_users PASSED [  8%]
tests/test_bot/test_scheduler.py::TestSetupUserNotificationSchedules::test_logs_info_if_no_users_found PASSED [  8%]
tests/test_bot/test_scheduler.py::TestSetupUserNotificationSchedules::test_raises_scheduler_setup_error_on_exception PASSED [  8%]
tests/test_bot/test_scheduler.py::TestSchedulerLifecycle::test_start_scheduler_calls_start PASSED [  9%]
tests/test_bot/test_scheduler.py::TestSchedulerLifecycle::test_stop_scheduler_calls_shutdown PASSED [  9%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handler_creation PASSED [  9%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_premium_success PASSED [  9%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_basic_success PASSED [  9%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_no_profile FAILED [  9%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_exception FAILED [  9%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_settings_callback_birth_date PASSED [ 10%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_settings_callback_language PASSED [ 10%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_settings_callback_life_expectancy PASSED [ 10%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_settings_callback_unknown PASSED [ 10%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_settings_callback_exception PASSED [ 10%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_language_callback_success FAILED [ 10%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_language_callback_invalid_language PASSED [ 11%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_language_callback_database_error FAILED [ 11%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_settings_input_birth_date PASSED [ 11%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_settings_input_life_expectancy PASSED [ 11%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_settings_input_not_waiting PASSED [ 11%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_settings_input_exception PASSED [ 11%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_birth_date_input_success FAILED [ 12%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_birth_date_input_future_date PASSED [ 12%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_birth_date_input_old_date PASSED [ 12%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_birth_date_input_database_error FAILED [ 12%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_birth_date_input_format_error PASSED [ 12%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_life_expectancy_input_success FAILED [ 12%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_life_expectancy_input_invalid_range PASSED [ 13%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_life_expectancy_input_database_error FAILED [ 13%]
tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_life_expectancy_input_format_error PASSED [ 13%]
tests/test_bot/test_start_handler.py::TestStartHandler::test_handler_creation PASSED [ 13%]
tests/test_bot/test_start_handler.py::TestStartHandler::test_handle_existing_user PASSED [ 13%]
tests/test_bot/test_start_handler.py::TestStartHandler::test_handle_new_user PASSED [ 13%]
tests/test_bot/test_start_handler.py::TestStartHandler::test_handle_birth_date_input_success PASSED [ 13%]
tests/test_bot/test_start_handler.py::TestStartHandler::test_handle_birth_date_input_future_date PASSED [ 14%]
tests/test_bot/test_start_handler.py::TestStartHandler::test_handle_birth_date_input_old_date PASSED [ 14%]
tests/test_bot/test_start_handler.py::TestStartHandler::test_handle_birth_date_input_invalid_format PASSED [ 14%]
tests/test_bot/test_start_handler.py::TestStartHandler::test_handle_birth_date_input_registration_error PASSED [ 14%]
tests/test_bot/test_start_handler.py::TestStartHandler::test_handle_birth_date_input_service_error PASSED [ 14%]
tests/test_bot/test_start_handler.py::TestStartHandler::test_handle_birth_date_input_scheduler_exception PASSED [ 14%]
tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handler_creation PASSED [ 15%]
tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_success FAILED [ 15%]
tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_no_profile FAILED [ 15%]
tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_exception FAILED [ 15%]
tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_subscription_callback_same_subscription FAILED [ 15%]
tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_subscription_callback_successful_change FAILED [ 15%]
tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_subscription_callback_update_error FAILED [ 16%]
tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_subscription_callback_general_exception FAILED [ 16%]
tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_subscription_callback_log_execution FAILED [ 16%]
tests/test_bot/test_unknown_handler.py::TestUnknownHandler::test_handler_creation PASSED [ 16%]
tests/test_bot/test_unknown_handler.py::TestUnknownHandler::test_handle_success PASSED [ 16%]
tests/test_bot/test_unknown_handler.py::TestUnknownHandler::test_handle_with_russian_user PASSED [ 16%]
tests/test_bot/test_unknown_handler.py::TestUnknownHandler::test_handle_with_no_language_code PASSED [ 17%]
tests/test_bot/test_unknown_handler.py::TestUnknownHandler::test_handle_with_ukrainian_user PASSED [ 17%]
tests/test_bot/test_unknown_handler.py::TestUnknownHandler::test_handle_with_belarusian_user PASSED [ 17%]
tests/test_bot/test_unknown_handler.py::TestUnknownHandler::test_handle_error_handling PASSED [ 17%]
tests/test_bot/test_unknown_handler.py::TestUnknownHandler::test_handle_with_text_message_non_command PASSED [ 17%]
tests/test_bot/test_unknown_handler.py::TestUnknownHandler::test_handle_with_other_message_type PASSED [ 17%]
tests/test_bot/test_unknown_handler.py::TestUnknownHandler::test_handle_with_simple_text_message PASSED [ 18%]
tests/test_bot/test_unknown_handler.py::TestUnknownHandler::test_handle_with_unknown_command PASSED [ 18%]
tests/test_bot/test_visualize_handler.py::TestVisualizeHandler::test_handler_creation PASSED [ 18%]
tests/test_bot/test_visualize_handler.py::TestVisualizeHandler::test_handle_success PASSED [ 18%]
tests/test_bot/test_visualize_handler.py::TestVisualizeHandler::test_handle_not_registered PASSED [ 18%]
tests/test_bot/test_visualize_handler.py::TestVisualizeHandler::test_handle_visualize_returns_none PASSED [ 18%]
tests/test_bot/test_weeks_handler.py::TestWeeksHandler::test_handler_creation PASSED [ 18%]
tests/test_bot/test_weeks_handler.py::TestWeeksHandler::test_handle_success PASSED [ 19%]
tests/test_bot/test_weeks_handler.py::TestWeeksHandler::test_handle_not_registered FAILED [ 19%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_calculate_age_exact_birthday PASSED [ 19%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_calculate_age_before_birthday PASSED [ 19%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_calculate_age_after_birthday PASSED [ 19%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_calculate_days_lived PASSED [ 19%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_calculate_weeks_lived PASSED [ 20%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_calculate_months_lived PASSED [ 20%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_calculate_years_and_remaining_weeks PASSED [ 20%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_calculate_remaining_weeks PASSED [ 20%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_calculate_life_percentage PASSED [ 20%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_get_next_birthday_same_year PASSED [ 20%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_get_next_birthday_next_year PASSED [ 21%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_days_until_next_birthday PASSED [ 21%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_get_life_statistics PASSED [ 21%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_edge_case_newborn PASSED [ 21%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_edge_case_elderly PASSED [ 21%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_invalid_user_no_birth_date PASSED [ 21%]
tests/test_core/test_life_calculator.py::TestLifeCalculatorEngine::test_invalid_user_no_settings PASSED [ 22%]
tests/test_core/test_life_calculator.py::TestLeapYearHandling::test_is_leap_year_helper_method PASSED [ 22%]
tests/test_core/test_life_calculator.py::TestLeapYearHandling::test_get_next_birthday_february_29_in_leap_year PASSED [ 22%]
tests/test_core/test_life_calculator.py::TestLeapYearHandling::test_get_next_birthday_february_29_in_non_leap_year PASSED [ 22%]
tests/test_core/test_life_calculator.py::TestLeapYearHandling::test_get_next_birthday_february_29_passed_this_year_leap PASSED [ 22%]
tests/test_core/test_life_calculator.py::TestLeapYearHandling::test_get_next_birthday_february_29_passed_this_year_non_leap PASSED [ 22%]
tests/test_core/test_life_calculator.py::TestLeapYearHandling::test_get_next_birthday_february_29_on_birthday_leap_year PASSED [ 22%]
tests/test_core/test_life_calculator.py::TestLeapYearHandling::test_get_next_birthday_february_29_on_birthday_non_leap_year PASSED [ 23%]
tests/test_core/test_life_calculator.py::TestLeapYearHandling::test_days_until_next_birthday_february_29_edge_case PASSED [ 23%]
tests/test_core/test_life_calculator.py::TestLeapYearHandling::test_life_statistics_with_february_29_birthday PASSED [ 23%]
tests/test_core/test_life_calculator.py::TestLeapYearHandling::test_century_leap_year_edge_cases PASSED [ 23%]
tests/test_core/test_life_calculator.py::TestLeapYearHandling::test_february_29_birthday_in_century_transition PASSED [ 23%]
tests/test_core/test_life_calculator.py::TestImprovedMonthsCalculation::test_exact_month_calculation_same_day PASSED [ 23%]
tests/test_core/test_life_calculator.py::TestImprovedMonthsCalculation::test_exact_month_calculation_different_day PASSED [ 24%]
tests/test_core/test_life_calculator.py::TestImprovedMonthsCalculation::test_exact_month_calculation_partial_month PASSED [ 24%]
tests/test_core/test_life_calculator.py::TestImprovedMonthsCalculation::test_exact_month_calculation_varying_month_lengths PASSED [ 24%]
tests/test_core/test_life_calculator.py::TestImprovedMonthsCalculation::test_exact_month_calculation_leap_year_february PASSED [ 24%]
tests/test_core/test_life_calculator.py::TestImprovedMonthsCalculation::test_exact_month_calculation_multi_year PASSED [ 24%]
tests/test_core/test_life_calculator.py::TestImprovedMonthsCalculation::test_exact_month_calculation_edge_case_month_end PASSED [ 24%]
tests/test_core/test_life_calculator.py::TestImprovedMonthsCalculation::test_exact_month_calculation_compared_to_old_method PASSED [ 25%]
tests/test_core/test_life_calculator.py::TestImprovedMonthsCalculation::test_exact_month_calculation_newborn PASSED [ 25%]
tests/test_core/test_life_calculator.py::TestImprovedMonthsCalculation::test_exact_month_calculation_exactly_one_month PASSED [ 25%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_week_success PASSED [ 25%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_week_user_not_found PASSED [ 25%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_week_russian_language PASSED [ 25%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_visualize_success PASSED [ 26%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_help_success PASSED [ 26%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_help_default_language PASSED [ 26%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_cancel_success PASSED [ 26%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_cancel_error PASSED [ 26%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_start_welcome_existing PASSED [ 26%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_start_welcome_new PASSED [ 27%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_registration_success PASSED [ 27%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_registration_error PASSED [ 27%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_birth_date_future_error PASSED [ 27%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_birth_date_old_error PASSED [ 27%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_birth_date_format_error PASSED [ 27%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_week_missing_stats_key PASSED [ 27%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_visualize_user_not_found PASSED [ 28%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_registration_success_user_not_found PASSED [ 28%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_registration_success_missing_stats PASSED [ 28%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_week_russian_language_no_lang_code PASSED [ 28%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_subscription_current_success PASSED [ 28%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_subscription_current_no_profile PASSED [ 28%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_subscription_current_no_subscription PASSED [ 29%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_subscription_invalid_type PASSED [ 29%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_subscription_profile_error PASSED [ 29%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_subscription_already_active PASSED [ 29%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_subscription_change_success PASSED [ 29%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_subscription_change_failed PASSED [ 29%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_subscription_change_error PASSED [ 30%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_week_addition_basic PASSED [ 30%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_week_addition_premium PASSED [ 30%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_message_unknown_command PASSED [ 30%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_settings_buttons_success PASSED [ 30%]
tests/test_core/test_messages.py::TestMessageGeneration::test_generate_settings_buttons_russian_language PASSED [ 30%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_settings_basic PASSED [ 31%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_settings_premium PASSED [ 31%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_change_birth_date PASSED [ 31%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_change_language PASSED [ 31%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_change_life_expectancy PASSED [ 31%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_birth_date_updated PASSED [ 31%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_language_updated PASSED [ 31%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_life_expectancy_updated PASSED [ 32%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_invalid_life_expectancy PASSED [ 32%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_settings_error PASSED [ 32%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_settings_basic_no_profile PASSED [ 32%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_settings_premium_no_profile PASSED [ 32%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_change_birth_date_no_profile PASSED [ 32%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_change_life_expectancy_no_profile PASSED [ 33%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_settings_basic_no_birth_date PASSED [ 33%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_settings_premium_no_birth_date PASSED [ 33%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_change_birth_date_no_birth_date PASSED [ 33%]
tests/test_core/test_messages.py::TestMessageSettings::test_get_user_language_no_profile_passed PASSED [ 33%]
tests/test_core/test_messages.py::TestMessageSettings::test_get_user_language_with_profile_settings PASSED [ 33%]
tests/test_core/test_messages.py::TestMessageSettings::test_get_user_language_with_profile_from_database PASSED [ 34%]
tests/test_core/test_messages.py::TestMessageSettings::test_generate_message_week_no_subscription PASSED [ 34%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_basic_success PASSED [ 34%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_basic_russian PASSED [ 34%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_basic_no_language PASSED [ 34%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_basic_custom_url PASSED [ 34%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_basic_default_url PASSED [ 35%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_basic_probability_high PASSED [ 35%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_basic_probability_exact PASSED [ 35%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_basic_probability_low PASSED [ 35%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_basic_custom_probability PASSED [ 35%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_basic_custom_probability_fail PASSED [ 35%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_premium_success PASSED [ 36%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_premium_russian PASSED [ 36%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_get_subscription_addition_message_premium PASSED [ 36%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_get_subscription_addition_message_trial PASSED [ 36%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_get_subscription_addition_message_basic PASSED [ 36%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_get_subscription_addition_message_unknown_type PASSED [ 36%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_basic_function_signature PASSED [ 36%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_generate_message_week_addition_premium_function_signature PASSED [ 37%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_get_subscription_addition_message_function_signature PASSED [ 37%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_integration_basic_message_generation PASSED [ 37%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_integration_premium_message_generation PASSED [ 37%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_integration_subscription_addition_message PASSED [ 37%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_buymeacoffee_url_parameter_passed_correctly PASSED [ 37%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_empty_buymeacoffee_url_handling PASSED [ 38%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_none_buymeacoffee_url_handling PASSED [ 38%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_module_imports_correctly PASSED [ 38%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_buymeacoffee_url_config_import PASSED [ 38%]
tests/test_core/test_subscription_messages.py::TestSubscriptionMessages::test_multiple_language_support_with_buymeacoffee PASSED [ 38%]
tests/test_database/test_service.py::TestUserServiceExceptions::test_user_service_error_inheritance PASSED [ 38%]
tests/test_database/test_service.py::TestUserServiceExceptions::test_user_not_found_error_inheritance PASSED [ 39%]
tests/test_database/test_service.py::TestUserServiceExceptions::test_user_deletion_error_inheritance PASSED [ 39%]
tests/test_database/test_service.py::TestUserServiceExceptions::test_user_profile_error_inheritance PASSED [ 39%]
tests/test_database/test_service.py::TestUserServiceExceptions::test_user_registration_error_inheritance PASSED [ 39%]
tests/test_database/test_service.py::TestUserServiceExceptions::test_user_already_exists_error_inheritance PASSED [ 39%]
tests/test_database/test_service.py::TestUserService::test_init_with_default_repositories PASSED [ 39%]
tests/test_database/test_service.py::TestUserService::test_init_with_custom_repositories PASSED [ 40%]
tests/test_database/test_service.py::TestUserService::test_initialize PASSED [ 40%]
tests/test_database/test_service.py::TestUserService::test_close PASSED  [ 40%]
tests/test_database/test_service.py::TestUserService::test_create_user_profile_success PASSED [ 40%]
tests/test_database/test_service.py::TestUserService::test_create_user_profile_user_exists PASSED [ 40%]
tests/test_database/test_service.py::TestUserService::test_create_user_profile_user_creation_fails PASSED [ 40%]
tests/test_database/test_service.py::TestUserService::test_create_user_profile_settings_creation_fails PASSED [ 40%]
tests/test_database/test_service.py::TestUserService::test_create_user_profile_subscription_creation_fails PASSED [ 41%]
tests/test_database/test_service.py::TestUserService::test_create_user_profile_exception PASSED [ 41%]
tests/test_database/test_service.py::TestUserService::test_get_user_profile_success PASSED [ 41%]
tests/test_database/test_service.py::TestUserService::test_get_user_profile_user_not_found PASSED [ 41%]
tests/test_database/test_service.py::TestUserService::test_get_user_profile_settings_not_found PASSED [ 41%]
tests/test_database/test_service.py::TestUserService::test_get_user_profile_subscription_not_found PASSED [ 41%]
tests/test_database/test_service.py::TestUserService::test_get_user_profile_exception PASSED [ 42%]
tests/test_database/test_service.py::TestUserService::test_user_exists_true PASSED [ 42%]
tests/test_database/test_service.py::TestUserService::test_user_exists_false_no_user PASSED [ 42%]
tests/test_database/test_service.py::TestUserService::test_user_exists_false_no_settings PASSED [ 42%]
tests/test_database/test_service.py::TestUserService::test_user_exists_exception PASSED [ 42%]
tests/test_database/test_service.py::TestUserService::test_is_valid_user_profile_true PASSED [ 42%]
tests/test_database/test_service.py::TestUserService::test_is_valid_user_profile_false_no_settings PASSED [ 43%]
tests/test_database/test_service.py::TestUserService::test_is_valid_user_profile_false_no_birth_date PASSED [ 43%]
tests/test_database/test_service.py::TestUserService::test_is_valid_user_profile_exception PASSED [ 43%]
tests/test_database/test_service.py::TestUserService::test_delete_user_success PASSED [ 43%]
tests/test_database/test_service.py::TestUserService::test_delete_user_failure PASSED [ 43%]
tests/test_database/test_service.py::TestUserService::test_delete_user_exception PASSED [ 43%]
tests/test_database/test_service.py::TestUserService::test_delete_user_profile_success PASSED [ 44%]
tests/test_database/test_service.py::TestUserService::test_delete_user_profile_no_settings PASSED [ 44%]
tests/test_database/test_service.py::TestUserService::test_delete_user_profile_user_deletion_fails PASSED [ 44%]
tests/test_database/test_service.py::TestUserService::test_delete_user_profile_user_deletion_error_reraise PASSED [ 44%]
tests/test_database/test_service.py::TestUserService::test_delete_user_profile_general_exception PASSED [ 44%]
tests/test_database/test_service.py::TestUserServiceUpdateSubscription::test_update_user_subscription_success PASSED [ 44%]
tests/test_database/test_service.py::TestUserServiceUpdateSubscription::test_update_user_subscription_not_found PASSED [ 45%]
tests/test_database/test_service.py::TestUserServiceUpdateSubscription::test_update_user_subscription_update_fails PASSED [ 45%]
tests/test_database/test_service.py::TestUserServiceUpdateSubscription::test_update_user_subscription_repository_exception PASSED [ 45%]
tests/test_database/test_service.py::TestUserServiceUpdateSubscription::test_update_user_subscription_get_subscription_exception PASSED [ 45%]
tests/test_database/test_service.py::TestUserServiceUpdateSettings::test_update_user_settings_success_all_fields PASSED [ 45%]
tests/test_database/test_service.py::TestUserServiceUpdateSettings::test_update_user_settings_success_partial_fields PASSED [ 45%]
tests/test_database/test_service.py::TestUserServiceUpdateSettings::test_update_user_settings_not_found PASSED [ 45%]
tests/test_database/test_service.py::TestUserServiceUpdateSettings::test_update_user_settings_update_fails PASSED [ 46%]
tests/test_database/test_service.py::TestUserServiceUpdateSettings::test_update_user_settings_repository_exception PASSED [ 46%]
tests/test_database/test_service.py::TestUserServiceUpdateSettings::test_update_user_settings_get_settings_exception PASSED [ 46%]
tests/test_database/test_service.py::TestUserServiceUpdateSettings::test_update_user_settings_no_fields_provided PASSED [ 46%]
tests/test_database/test_service.py::TestUserServiceDeleteUserProfile::test_delete_user_profile_success_all_components PASSED [ 46%]
tests/test_database/test_service.py::TestUserServiceDeleteUserProfile::test_delete_user_profile_success_missing_settings PASSED [ 46%]
tests/test_database/test_service.py::TestUserServiceDeleteUserProfile::test_delete_user_profile_success_missing_subscription PASSED [ 47%]
tests/test_database/test_service.py::TestUserServiceDeleteUserProfile::test_delete_user_profile_user_not_found PASSED [ 47%]
tests/test_database/test_service.py::TestUserServiceDeleteUserProfile::test_delete_user_profile_general_exception PASSED [ 47%]
tests/test_database/test_service.py::TestUserServiceGetAllUsers::test_get_all_users_with_incomplete_profiles PASSED [ 47%]
tests/test_database/test_service.py::TestUserServiceGetAllUsers::test_get_all_users_repository_exception PASSED [ 47%]
tests/test_database/test_service.py::TestUserServiceGetAllUsers::test_get_all_users_profile_building_exception PASSED [ 47%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_creation_basic PASSED [ 48%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_creation_with_all_fields PASSED [ 48%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_default_values PASSED [ 48%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_week_day_enum_values PASSED [ 48%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_life_expectancy_validation PASSED [ 48%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_birth_date_validation PASSED [ 48%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_notifications_boolean PASSED [ 49%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_repr PASSED [ 49%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_str PASSED [ 49%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_equality PASSED [ 49%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_week_day_enum_values PASSED [ 49%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_week_day_enum_ordering PASSED [ 49%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_updated_at_auto_population PASSED [ 50%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_none_birth_date PASSED [ 50%]
tests/test_database/test_models/test_user_settings.py::TestUserSettings::test_user_settings_extreme_life_expectancy_values PASSED [ 50%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_creation_basic PASSED [ 50%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_creation_with_all_fields PASSED [ 50%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_subscription_type_enum_values PASSED [ 50%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_subscription_type_basic PASSED [ 50%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_subscription_type_premium PASSED [ 51%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_is_active_boolean PASSED [ 51%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_default_expiration_constant PASSED [ 51%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_expiration_calculation PASSED [ 51%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_repr PASSED [ 51%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_str PASSED [ 51%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_equality PASSED [ 52%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_subscription_type_enum_has_expected_values PASSED [ 52%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_created_at_datetime PASSED [ 52%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_expires_at_datetime PASSED [ 52%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_none_expires_at PASSED [ 52%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_expired_subscription PASSED [ 52%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_future_expiration PASSED [ 53%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_subscription_upgrade_scenario PASSED [ 53%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_user_subscription_with_different_telegram_ids PASSED [ 53%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_subscription_type_get_choices PASSED [ 53%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_subscription_type_is_valid PASSED [ 53%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_create_user_subscription_basic_defaults PASSED [ 53%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_create_user_subscription_premium_no_expiry PASSED [ 54%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_create_user_subscription_with_explicit_expiry PASSED [ 54%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_create_user_subscription_invalid_telegram_id PASSED [ 54%]
tests/test_database/test_models/test_user_subscription.py::TestUserSubscription::test_create_user_subscription_invalid_subscription_type PASSED [ 54%]
tests/test_database/test_repositories/test_abstract_base_repository.py::TestAbstractBaseRepository::test_abstract_class_inheritance PASSED [ 54%]
tests/test_database/test_repositories/test_abstract_base_repository.py::TestAbstractBaseRepository::test_cannot_instantiate_abstract_class PASSED [ 54%]
tests/test_database/test_repositories/test_abstract_base_repository.py::TestAbstractBaseRepository::test_concrete_implementation_initialization PASSED [ 54%]
tests/test_database/test_repositories/test_abstract_base_repository.py::TestAbstractBaseRepository::test_concrete_implementation_default_path PASSED [ 55%]
tests/test_database/test_repositories/test_abstract_base_repository.py::TestAbstractBaseRepository::test_concrete_implementation_initialize PASSED [ 55%]
tests/test_database/test_repositories/test_abstract_base_repository.py::TestAbstractBaseRepository::test_concrete_implementation_close PASSED [ 55%]
tests/test_database/test_repositories/test_abstract_base_repository.py::TestAbstractBaseRepository::test_concrete_implementation_session PASSED [ 55%]
tests/test_database/test_repositories/test_abstract_base_repository.py::TestAbstractBaseRepository::test_concrete_implementation_detach_instance PASSED [ 55%]
tests/test_database/test_repositories/test_abstract_base_repository.py::TestAbstractBaseRepository::test_abstract_methods_exist PASSED [ 55%]
tests/test_database/test_repositories/test_abstract_base_repository.py::TestAbstractBaseRepository::test_concrete_class_implements_all_methods PASSED [ 56%]
tests/test_database/test_repositories/test_abstract_base_repository.py::TestAbstractBaseRepository::test_init_stores_db_path PASSED [ 56%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_init_default_path PASSED [ 56%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_init_custom_path PASSED [ 56%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_initialize_success PASSED [ 56%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_initialize_failure PASSED [ 56%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_initialize_idempotent PASSED [ 57%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_close_success PASSED [ 57%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_close_when_not_initialized PASSED [ 57%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_session_context_manager_success PASSED [ 57%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_session_not_initialized PASSED [ 57%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_session_rollback_on_error PASSED [ 57%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_detach_instance_in_session PASSED [ 58%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_detach_instance_not_in_session PASSED [ 58%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_detach_instance_none PASSED [ 58%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_create_entity_success PASSED [ 58%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_create_entity_integrity_error PASSED [ 58%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_create_entity_general_error PASSED [ 58%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_get_entity_by_telegram_id_success PASSED [ 59%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_get_entity_by_telegram_id_not_found PASSED [ 59%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_get_entity_by_telegram_id_error PASSED [ 59%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_delete_entity_by_telegram_id_success PASSED [ 59%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_delete_entity_by_telegram_id_not_found PASSED [ 59%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_delete_entity_by_telegram_id_error PASSED [ 59%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_get_all_entities_success PASSED [ 59%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_get_all_entities_empty PASSED [ 60%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_get_all_entities_error PASSED [ 60%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_get_all_entities_detach_instances PASSED [ 60%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_session_expire_on_commit_false PASSED [ 60%]
tests/test_database/test_repositories/test_base_sqlite_repository.py::TestBaseSQLiteRepository::test_model_type_generic PASSED [ 60%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_init_default_path PASSED [ 60%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_init_custom_path PASSED [ 61%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_initialize_success PASSED [ 61%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_initialize_failure PASSED [ 61%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_close_success PASSED [ 61%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_create_user_success PASSED [ 61%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_create_user_duplicate PASSED [ 61%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_create_user_database_error PASSED [ 62%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_get_user_success PASSED [ 62%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_get_user_not_found PASSED [ 62%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_get_user_database_error PASSED [ 62%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_update_user_success PASSED [ 62%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_update_user_not_found PASSED [ 62%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_update_user_database_error PASSED [ 63%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_delete_user_success PASSED [ 63%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_delete_user_not_found PASSED [ 63%]
tests/test_database/test_repositories/test_sqlite_user_repository.py::TestSQLiteUserRepository::test_delete_user_database_error PASSED [ 63%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_init_default_path PASSED [ 63%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_init_custom_path PASSED [ 63%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_initialize_success PASSED [ 63%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_initialize_failure PASSED [ 64%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_close_success PASSED [ 64%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_create_user_settings_success PASSED [ 64%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_create_user_settings_duplicate PASSED [ 64%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_create_user_settings_database_error PASSED [ 64%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_get_user_settings_success PASSED [ 64%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_get_user_settings_not_found PASSED [ 65%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_get_user_settings_database_error PASSED [ 65%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_update_user_settings_success PASSED [ 65%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_update_user_settings_not_found PASSED [ 65%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_update_user_settings_database_error PASSED [ 65%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_delete_user_settings_success PASSED [ 65%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_delete_user_settings_not_found PASSED [ 66%]
tests/test_database/test_repositories/test_sqlite_user_settings_repository.py::TestSQLiteUserSettingsRepository::test_delete_user_settings_database_error PASSED [ 66%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_init_default_path PASSED [ 66%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_init_custom_path PASSED [ 66%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_initialize_success PASSED [ 66%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_initialize_failure PASSED [ 66%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_close_success PASSED [ 67%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_create_subscription_success PASSED [ 67%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_create_subscription_duplicate PASSED [ 67%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_create_subscription_database_error PASSED [ 67%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_get_subscription_success PASSED [ 67%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_get_subscription_not_found PASSED [ 67%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_get_subscription_database_error PASSED [ 68%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_update_subscription_success PASSED [ 68%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_update_subscription_not_found PASSED [ 68%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_update_subscription_database_error PASSED [ 68%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_delete_subscription_success PASSED [ 68%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_delete_subscription_not_found PASSED [ 68%]
tests/test_database/test_repositories/test_sqlite_user_subscription_repository.py::TestSQLiteUserSubscriptionRepository::test_delete_subscription_database_error PASSED [ 68%]
tests/test_database/test_schemas/test_base.py::TestBaseSchema::test_base_schema_creation_success PASSED [ 69%]
tests/test_database/test_schemas/test_base.py::TestBaseSchema::test_base_schema_from_attributes_true PASSED [ 69%]
tests/test_database/test_schemas/test_base.py::TestBaseSchema::test_base_schema_validate_assignment_true PASSED [ 69%]
tests/test_database/test_schemas/test_base.py::TestBaseSchema::test_base_schema_extra_forbid PASSED [ 69%]
tests/test_database/test_schemas/test_base.py::TestBaseSchema::test_base_schema_json_serialization PASSED [ 69%]
tests/test_database/test_schemas/test_base.py::TestBaseSchema::test_base_schema_validation_error_on_invalid_data PASSED [ 69%]
tests/test_database/test_schemas/test_base.py::TestBaseSchema::test_base_schema_model_config_attributes PASSED [ 70%]
tests/test_database/test_schemas/test_base.py::TestBaseSchema::test_base_schema_datetime_serializer PASSED [ 70%]
tests/test_database/test_schemas/test_base.py::TestBaseSchema::test_base_schema_inheritance PASSED [ 70%]
tests/test_database/test_schemas/test_init.py::TestSchemasPackageInit::test_schemas_package_imports PASSED [ 70%]
tests/test_database/test_schemas/test_init.py::TestSchemasPackageInit::test_schemas_package_all_export PASSED [ 70%]
tests/test_database/test_schemas/test_init.py::TestSchemasPackageInit::test_schemas_can_instantiate_classes PASSED [ 70%]
tests/test_database/test_schemas/test_init.py::TestSchemasPackageInit::test_schemas_package_no_extra_exports PASSED [ 71%]
tests/test_database/test_schemas/test_init.py::TestSchemasPackageInit::test_schemas_package_module_docstring PASSED [ 71%]
tests/test_database/test_schemas/test_user.py::TestUserBase::test_user_base_creation_with_required_fields PASSED [ 71%]
tests/test_database/test_schemas/test_user.py::TestUserBase::test_user_base_creation_with_all_fields PASSED [ 71%]
tests/test_database/test_schemas/test_user.py::TestUserBase::test_user_base_telegram_id_required PASSED [ 71%]
tests/test_database/test_schemas/test_user.py::TestUserBase::test_user_base_telegram_id_validation PASSED [ 71%]
tests/test_database/test_schemas/test_user.py::TestUserBase::test_user_base_optional_fields_none PASSED [ 72%]
tests/test_database/test_schemas/test_user.py::TestUserCreate::test_user_create_inherits_from_user_base PASSED [ 72%]
tests/test_database/test_schemas/test_user.py::TestUserCreate::test_user_create_with_all_fields PASSED [ 72%]
tests/test_database/test_schemas/test_user.py::TestUserUpdate::test_user_update_all_fields_optional PASSED [ 72%]
tests/test_database/test_schemas/test_user.py::TestUserUpdate::test_user_update_with_some_fields PASSED [ 72%]
tests/test_database/test_schemas/test_user.py::TestUserUpdate::test_user_update_with_all_fields PASSED [ 72%]
tests/test_database/test_schemas/test_user.py::TestUserInDB::test_user_in_db_creation_with_required_fields PASSED [ 72%]
tests/test_database/test_schemas/test_user.py::TestUserInDB::test_user_in_db_creation_with_all_fields PASSED [ 73%]
tests/test_database/test_schemas/test_user.py::TestUserInDB::test_user_in_db_created_at_required PASSED [ 73%]
tests/test_database/test_schemas/test_user.py::TestUserInDB::test_user_in_db_created_at_validation PASSED [ 73%]
tests/test_database/test_schemas/test_user.py::TestUserInDB::test_user_in_db_inherits_from_user_base PASSED [ 73%]
tests/test_database/test_schemas/test_user.py::TestUserResponse::test_user_response_inherits_from_user_in_db PASSED [ 73%]
tests/test_database/test_schemas/test_user.py::TestUserResponse::test_user_response_with_all_fields PASSED [ 73%]
tests/test_database/test_schemas/test_user.py::TestUserSchemaIntegration::test_user_schema_json_serialization PASSED [ 74%]
tests/test_database/test_schemas/test_user.py::TestUserSchemaIntegration::test_user_base_to_user_create_compatibility PASSED [ 74%]
tests/test_database/test_schemas/test_user.py::TestUserSchemaIntegration::test_user_update_partial_data PASSED [ 74%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsBase::test_user_settings_base_creation_with_required_fields PASSED [ 74%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsBase::test_user_settings_base_creation_with_all_fields PASSED [ 74%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsBase::test_user_settings_base_telegram_id_required PASSED [ 74%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsBase::test_user_settings_base_telegram_id_validation PASSED [ 75%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsBase::test_user_settings_base_birth_date_validation PASSED [ 75%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsBase::test_user_settings_base_life_expectancy_validation PASSED [ 75%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsBase::test_user_settings_base_notifications_validation PASSED [ 75%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsBase::test_user_settings_base_notifications_time_validation PASSED [ 75%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsBase::test_user_settings_base_default_notifications PASSED [ 75%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsCreate::test_user_settings_create_inherits_from_base PASSED [ 76%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsCreate::test_user_settings_create_with_all_fields PASSED [ 76%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsUpdate::test_user_settings_update_all_fields_optional PASSED [ 76%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsUpdate::test_user_settings_update_with_some_fields PASSED [ 76%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsUpdate::test_user_settings_update_with_all_fields PASSED [ 76%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsInDB::test_user_settings_in_db_creation_with_required_fields PASSED [ 76%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsInDB::test_user_settings_in_db_creation_with_all_fields PASSED [ 77%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsInDB::test_user_settings_in_db_id_required PASSED [ 77%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsInDB::test_user_settings_in_db_updated_at_required PASSED [ 77%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsInDB::test_user_settings_in_db_inherits_from_base PASSED [ 77%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsResponse::test_user_settings_response_inherits_from_in_db PASSED [ 77%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsResponse::test_user_settings_response_with_all_fields PASSED [ 77%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsSchemaIntegration::test_user_settings_schema_json_serialization PASSED [ 77%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsSchemaIntegration::test_user_settings_base_to_create_compatibility PASSED [ 78%]
tests/test_database/test_schemas/test_user_settings.py::TestUserSettingsSchemaIntegration::test_user_settings_update_partial_data PASSED [ 78%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionBase::test_user_subscription_base_creation_with_required_fields PASSED [ 78%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionBase::test_user_subscription_base_creation_with_all_fields PASSED [ 78%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionBase::test_user_subscription_base_telegram_id_required PASSED [ 78%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionBase::test_user_subscription_base_telegram_id_validation PASSED [ 78%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionBase::test_user_subscription_base_is_active_validation PASSED [ 79%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionBase::test_user_subscription_base_expires_at_validation PASSED [ 79%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionBase::test_user_subscription_base_default_is_active PASSED [ 79%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionBase::test_user_subscription_base_expires_at_none PASSED [ 79%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionCreate::test_user_subscription_create_inherits_from_base PASSED [ 79%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionCreate::test_user_subscription_create_with_all_fields PASSED [ 79%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionUpdate::test_user_subscription_update_all_fields_optional PASSED [ 80%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionUpdate::test_user_subscription_update_with_some_fields PASSED [ 80%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionUpdate::test_user_subscription_update_with_all_fields PASSED [ 80%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionUpdate::test_user_subscription_update_expires_at_none PASSED [ 80%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionInDB::test_user_subscription_in_db_creation_with_required_fields PASSED [ 80%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionInDB::test_user_subscription_in_db_creation_with_all_fields PASSED [ 80%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionInDB::test_user_subscription_in_db_id_required PASSED [ 81%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionInDB::test_user_subscription_in_db_created_at_required PASSED [ 81%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionInDB::test_user_subscription_in_db_id_validation PASSED [ 81%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionInDB::test_user_subscription_in_db_created_at_validation PASSED [ 81%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionInDB::test_user_subscription_in_db_inherits_from_base PASSED [ 81%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionResponse::test_user_subscription_response_inherits_from_in_db PASSED [ 81%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionResponse::test_user_subscription_response_with_all_fields PASSED [ 81%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionSchemaIntegration::test_user_subscription_schema_json_serialization PASSED [ 82%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionSchemaIntegration::test_user_subscription_base_to_create_compatibility PASSED [ 82%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionSchemaIntegration::test_user_subscription_update_partial_data PASSED [ 82%]
tests/test_database/test_schemas/test_user_subscription.py::TestUserSubscriptionSchemaIntegration::test_user_subscription_schema_datetime_handling PASSED [ 82%]
tests/test_services/test_container.py::TestServiceContainer::test_container_creation PASSED [ 82%]
tests/test_services/test_container.py::TestServiceContainer::test_get_user_service PASSED [ 82%]
tests/test_services/test_container.py::TestServiceContainer::test_get_life_calculator PASSED [ 83%]
tests/test_services/test_container.py::TestServiceContainer::test_get_message PASSED [ 83%]
tests/test_services/test_container.py::TestServiceContainer::test_get_supported_languages PASSED [ 83%]
tests/test_services/test_container.py::TestServiceContainer::test_cleanup PASSED [ 83%]
tests/test_services/test_container.py::TestServiceContainer::test_service_initialization_order PASSED [ 83%]
tests/test_services/test_fake_container.py::TestFakeServiceContainer::test_fake_container_creation PASSED [ 83%]
tests/test_services/test_fake_container.py::TestFakeServiceContainer::test_mock_behaviors_setup PASSED [ 84%]
tests/test_services/test_fake_container.py::TestFakeServiceContainer::test_get_user_service PASSED [ 84%]
tests/test_services/test_fake_container.py::TestFakeServiceContainer::test_get_life_calculator PASSED [ 84%]
tests/test_services/test_fake_container.py::TestFakeServiceContainer::test_get_message PASSED [ 84%]
tests/test_services/test_fake_container.py::TestFakeServiceContainer::test_get_supported_languages PASSED [ 84%]
tests/test_services/test_fake_container.py::TestFakeServiceContainer::test_cleanup PASSED [ 84%]
tests/test_services/test_fake_container.py::TestFakeServiceContainer::test_custom_mock_behaviors PASSED [ 85%]
tests/test_services/test_fake_container.py::TestFakeServiceContainer::test_interface_compatibility PASSED [ 85%]
tests/test_utils/test_config.py::TestConfig::test_bot_name_constant PASSED [ 85%]
tests/test_utils/test_config.py::TestConfig::test_default_language_constant PASSED [ 85%]
tests/test_utils/test_config.py::TestConfig::test_visualization_constants PASSED [ 85%]
tests/test_utils/test_config.py::TestConfig::test_colors_constant PASSED [ 85%]
tests/test_utils/test_config.py::TestConfig::test_scheduler_configuration PASSED [ 86%]
tests/test_utils/test_config.py::TestConfig::test_buymeacoffee_url_from_env PASSED [ 86%]
tests/test_utils/test_config.py::TestConfig::test_buymeacoffee_url_default_value PASSED [ 86%]
tests/test_utils/test_config.py::TestConfig::test_buymeacoffee_url_empty_env PASSED [ 86%]
tests/test_utils/test_config.py::TestConfig::test_buymeacoffee_url_custom_value PASSED [ 86%]
tests/test_utils/test_config.py::TestConfig::test_buymeacoffee_url_type PASSED [ 86%]
tests/test_utils/test_config.py::TestConfig::test_buymeacoffee_url_format PASSED [ 86%]
tests/test_utils/test_config.py::TestConfig::test_token_loading PASSED   [ 87%]
tests/test_utils/test_config.py::TestConfig::test_chat_id_loading PASSED [ 87%]
tests/test_utils/test_config.py::TestConfig::test_config_module_imports PASSED [ 87%]
tests/test_utils/test_config.py::TestConfig::test_config_constants_immutability PASSED [ 87%]
tests/test_utils/test_config.py::TestConfig::test_buymeacoffee_url_reload_behavior PASSED [ 87%]
tests/test_utils/test_config.py::TestConfig::test_config_documentation PASSED [ 87%]
tests/test_utils/test_config.py::TestConfig::test_subscription_message_probability_default PASSED [ 88%]
tests/test_utils/test_config.py::TestConfig::test_subscription_message_probability_constant PASSED [ 88%]
tests/test_utils/test_config.py::TestConfig::test_subscription_message_probability_from_env PASSED [ 88%]
tests/test_utils/test_config.py::TestConfig::test_subscription_message_probability_default_value PASSED [ 88%]
tests/test_utils/test_config.py::TestConfig::test_subscription_message_probability_invalid_env PASSED [ 88%]
tests/test_utils/test_config.py::TestConfig::test_subscription_message_probability_zero PASSED [ 88%]
tests/test_utils/test_config.py::TestConfig::test_subscription_message_probability_hundred PASSED [ 89%]
tests/test_utils/test_config.py::TestConfig::test_subscription_message_probability_range PASSED [ 89%]
tests/test_utils/test_config.py::TestConfig::test_config_module_imports_with_probability PASSED [ 89%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_valid_key_ru PASSED [ 89%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_valid_key_en PASSED [ 89%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_unsupported_language_fallback PASSED [ 89%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_invalid_key_fallback PASSED [ 90%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_invalid_subkey_fallback PASSED [ 90%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_with_formatting_parameters PASSED [ 90%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_fallback_to_default_language PASSED [ 90%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_fallback_scenario_with_missing_translation PASSED [ 90%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_fallback_logic_with_mock PASSED [ 90%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_fallback_logic_with_kwargs PASSED [ 90%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_complete_fallback_failure PASSED [ 91%]
tests/test_utils/test_localization.py::TestLocalization::test_get_supported_languages PASSED [ 91%]
tests/test_utils/test_localization.py::TestLocalization::test_is_language_supported_valid PASSED [ 91%]
tests/test_utils/test_localization.py::TestLocalization::test_is_language_supported_invalid PASSED [ 91%]
tests/test_utils/test_localization.py::TestLocalization::test_is_language_supported_edge_cases PASSED [ 91%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_all_supported_languages PASSED [ 91%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_birth_date_validation_errors PASSED [ 92%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_command_weeks_not_registered PASSED [ 92%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_statistics_formatting PASSED [ 92%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_case_sensitivity PASSED [ 92%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_empty_parameters PASSED [ 92%]
tests/test_utils/test_localization.py::TestLocalization::test_get_message_missing_parameters PASSED [ 92%]
tests/test_utils/test_localization.py::TestLocalization::test_get_subscription_description_basic_ru PASSED [ 93%]
tests/test_utils/test_localization.py::TestLocalization::test_get_subscription_description_premium_en PASSED [ 93%]
tests/test_utils/test_localization.py::TestLocalization::test_get_subscription_description_trial_ru PASSED [ 93%]
tests/test_utils/test_localization.py::TestLocalization::test_get_subscription_description_unknown_type PASSED [ 93%]
tests/test_utils/test_localization.py::TestLocalization::test_get_subscription_description_unsupported_language PASSED [ 93%]
tests/test_utils/test_localization.py::TestLocalization::test_get_subscription_description_fallback_to_default_language PASSED [ 93%]
tests/test_utils/test_localization.py::TestLocalization::test_get_subscription_description_unknown_type_with_fallback PASSED [ 94%]
tests/test_utils/test_localization.py::TestLocalization::test_get_subscription_description_fallback_logic_with_mock PASSED [ 94%]
tests/test_utils/test_localization.py::TestLocalization::test_get_subscription_description_complete_fallback_failure PASSED [ 94%]
tests/test_utils/test_localization.py::TestLocalization::test_basic_addition_message_with_buymeacoffee_url_ru PASSED [ 94%]
tests/test_utils/test_localization.py::TestLocalization::test_basic_addition_message_with_buymeacoffee_url_en PASSED [ 94%]
tests/test_utils/test_localization.py::TestLocalization::test_basic_addition_message_with_default_buymeacoffee_url PASSED [ 94%]
tests/test_utils/test_localization.py::TestLocalization::test_basic_addition_message_with_custom_buymeacoffee_url PASSED [ 95%]
tests/test_utils/test_localization.py::TestLocalization::test_basic_addition_message_with_empty_buymeacoffee_url PASSED [ 95%]
tests/test_utils/test_localization.py::TestLocalization::test_basic_addition_message_with_none_buymeacoffee_url PASSED [ 95%]
tests/test_utils/test_localization.py::TestLocalization::test_basic_addition_message_missing_buymeacoffee_url PASSED [ 95%]
tests/test_utils/test_localization.py::TestLocalization::test_premium_addition_message_no_buymeacoffee_url PASSED [ 95%]
tests/test_utils/test_localization.py::TestLocalization::test_basic_addition_message_formatting_with_url PASSED [ 95%]
tests/test_utils/test_localization.py::TestLocalization::test_basic_addition_message_multiple_languages_with_url PASSED [ 95%]
tests/test_utils/test_localization.py::TestLocalization::test_basic_addition_message_url_placement PASSED [ 96%]
tests/test_utils/test_localization.py::TestLocalization::test_get_localized_language_name_valid_combinations PASSED [ 96%]
tests/test_utils/test_localization.py::TestLocalization::test_get_localized_language_name_unsupported_target_language PASSED [ 96%]
tests/test_utils/test_localization.py::TestLocalization::test_get_localized_language_name_unsupported_language PASSED [ 96%]
tests/test_utils/test_localization.py::TestLocalization::test_get_localized_language_name_edge_cases PASSED [ 96%]
tests/test_utils/test_localization.py::TestLocalization::test_localization_module_imports PASSED [ 96%]
tests/test_utils/test_logger.py::TestLogger::test_get_logger_returns_logger_instance PASSED [ 97%]
tests/test_utils/test_logger.py::TestLogger::test_get_logger_with_existing_name PASSED [ 97%]
tests/test_utils/test_logger.py::TestLogger::test_get_logger_with_different_names PASSED [ 97%]
tests/test_utils/test_logger.py::TestLogger::test_get_logger_default_level PASSED [ 97%]
tests/test_utils/test_logger.py::TestLogger::test_set_log_level_valid_levels PASSED [ 97%]
tests/test_utils/test_logger.py::TestLogger::test_set_log_level_invalid_level PASSED [ 97%]
tests/test_utils/test_logger.py::TestLogger::test_set_log_level_string_level PASSED [ 98%]
tests/test_utils/test_logger.py::TestLogger::test_logger_has_handlers PASSED [ 98%]
tests/test_utils/test_logger.py::TestLogger::test_logger_console_output PASSED [ 98%]
tests/test_utils/test_logger.py::TestLogger::test_logger_file_creation PASSED [ 98%]
tests/test_utils/test_logger.py::TestLogger::test_module_specific_log_levels PASSED [ 98%]
tests/test_utils/test_logger.py::TestLogger::test_logger_format_configuration PASSED [ 98%]
tests/test_utils/test_logger.py::TestLogger::test_logger_with_module_name PASSED [ 99%]
tests/test_utils/test_logger.py::TestLogger::test_third_party_module_suppression PASSED [ 99%]
tests/test_utils/test_logger.py::TestLogger::test_logger_exception_handling PASSED [ 99%]
tests/test_utils/test_logger.py::TestLogger::test_set_log_level_updates_existing_logger PASSED [ 99%]
tests/test_utils/test_logger.py::TestLogger::test_logs_directory_creation PASSED [ 99%]
tests/test_utils/test_logger.py::TestLogger::test_logger_utf8_encoding PASSED [ 99%]
tests/test_utils/test_logger.py::TestLogger::test_multiple_logger_instances_independence PASSED [100%]

=================================== FAILURES ===================================
_________ TestLifeWeeksBot.test_register_handlers_with_message_handler _________
tests/test_bot/test_application.py:369: in test_register_handlers_with_message_handler
    assert mock_handlers["test_cmd"]["class"]().handle in registered_callbacks
E   TypeError: mock_handlers.<locals>.<lambda>() missing 1 required positional argument: 'services'
---------------------------- Captured stdout setup -----------------------------
2025-08-05 21:17:33 - LifeWeeksBot - INFO - SQLite database initialized at lifeweeks.db
2025-08-05 21:17:33 - LifeWeeksBot - INFO - SQLite database initialized at lifeweeks.db
2025-08-05 21:17:33 - LifeWeeksBot - INFO - SQLite database initialized at lifeweeks.db
2025-08-05 21:17:33 - LifeWeeksBot - INFO - Initializing LifeWeeksBot
------------------------------ Captured log setup ------------------------------
INFO     LifeWeeksBot:base_repository.py:68 SQLite database initialized at lifeweeks.db
INFO     LifeWeeksBot:base_repository.py:68 SQLite database initialized at lifeweeks.db
INFO     LifeWeeksBot:base_repository.py:68 SQLite database initialized at lifeweeks.db
INFO     LifeWeeksBot:application.py:138 Initializing LifeWeeksBot
----------------------------- Captured stdout call -----------------------------
2025-08-05 21:17:33 - LifeWeeksBot - INFO - Command handlers registered: /test_cmd
2025-08-05 21:17:33 - LifeWeeksBot - INFO - Registered universal text handler for routing text input
2025-08-05 21:17:33 - LifeWeeksBot - INFO - Message handlers registered: /test_cmd_message_handler
------------------------------ Captured log call -------------------------------
INFO     LifeWeeksBot:application.py:233 Command handlers registered: /test_cmd
INFO     LifeWeeksBot:application.py:269 Registered universal text handler for routing text input
INFO     LifeWeeksBot:application.py:280 Message handlers registered: /test_cmd_message_handler
__________________ TestSettingsHandler.test_handle_no_profile __________________
tests/test_bot/test_settings_handler.py:164: in test_handle_no_profile
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.base_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/base_handler.py'> does not have the attribute 'user_service'
__________________ TestSettingsHandler.test_handle_exception ___________________
tests/test_bot/test_settings_handler.py:206: in test_handle_exception
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.settings_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/settings_handler.py'> does not have the attribute 'user_service'
__________ TestSettingsHandler.test_handle_language_callback_success ___________
tests/test_bot/test_settings_handler.py:408: in test_handle_language_callback_success
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.settings_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/settings_handler.py'> does not have the attribute 'user_service'
_______ TestSettingsHandler.test_handle_language_callback_database_error _______
tests/test_bot/test_settings_handler.py:488: in test_handle_language_callback_database_error
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.settings_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/settings_handler.py'> does not have the attribute 'user_service'
___________ TestSettingsHandler.test_handle_birth_date_input_success ___________
tests/test_bot/test_settings_handler.py:644: in test_handle_birth_date_input_success
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.settings_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/settings_handler.py'> does not have the attribute 'user_service'
_______ TestSettingsHandler.test_handle_birth_date_input_database_error ________
tests/test_bot/test_settings_handler.py:761: in test_handle_birth_date_input_database_error
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.settings_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/settings_handler.py'> does not have the attribute 'user_service'
________ TestSettingsHandler.test_handle_life_expectancy_input_success _________
tests/test_bot/test_settings_handler.py:830: in test_handle_life_expectancy_input_success
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.settings_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/settings_handler.py'> does not have the attribute 'user_service'
_____ TestSettingsHandler.test_handle_life_expectancy_input_database_error _____
tests/test_bot/test_settings_handler.py:897: in test_handle_life_expectancy_input_database_error
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.settings_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/settings_handler.py'> does not have the attribute 'user_service'
_________________ TestSubscriptionHandler.test_handle_success __________________
tests/test_bot/test_subscription_handler.py:81: in test_handle_success
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.subscription_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/subscription_handler.py'> does not have the attribute 'user_service'
________________ TestSubscriptionHandler.test_handle_no_profile ________________
tests/test_bot/test_subscription_handler.py:124: in test_handle_no_profile
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.base_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/base_handler.py'> does not have the attribute 'user_service'
________________ TestSubscriptionHandler.test_handle_exception _________________
tests/test_bot/test_subscription_handler.py:165: in test_handle_exception
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.base_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/base_handler.py'> does not have the attribute 'user_service'
_ TestSubscriptionHandler.test_handle_subscription_callback_same_subscription __
tests/test_bot/test_subscription_handler.py:203: in test_handle_subscription_callback_same_subscription
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.base_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/base_handler.py'> does not have the attribute 'user_service'
_ TestSubscriptionHandler.test_handle_subscription_callback_successful_change __
tests/test_bot/test_subscription_handler.py:243: in test_handle_subscription_callback_successful_change
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.subscription_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/subscription_handler.py'> does not have the attribute 'user_service'
____ TestSubscriptionHandler.test_handle_subscription_callback_update_error ____
tests/test_bot/test_subscription_handler.py:298: in test_handle_subscription_callback_update_error
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.subscription_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/subscription_handler.py'> does not have the attribute 'user_service'
_ TestSubscriptionHandler.test_handle_subscription_callback_general_exception __
tests/test_bot/test_subscription_handler.py:342: in test_handle_subscription_callback_general_exception
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.subscription_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/subscription_handler.py'> does not have the attribute 'user_service'
___ TestSubscriptionHandler.test_handle_subscription_callback_log_execution ____
tests/test_bot/test_subscription_handler.py:386: in test_handle_subscription_callback_log_execution
    with patch(
/usr/lib/python3.12/unittest/mock.py:1458: in __enter__
    original, local = self.get_original()
/usr/lib/python3.12/unittest/mock.py:1431: in get_original
    raise AttributeError(
E   AttributeError: <module 'src.bot.handlers.base_handler' from '/mnt/c/Users/AnatolKhmialeuski/Workspace/telegram_myweeks_life_bot/src/bot/handlers/base_handler.py'> does not have the attribute 'user_service'
_________________ TestWeeksHandler.test_handle_not_registered __________________
tests/test_bot/test_weeks_handler.py:104: in test_handle_not_registered
    assert call_args.args[0] == "Please register first!"
E   AssertionError: assert 'Mock message: common.not_registered (en)' == 'Please register first!'
E     - Please register first!
E     + Mock message: common.not_registered (en)
=========================== short test summary info ============================
FAILED tests/test_bot/test_application.py::TestLifeWeeksBot::test_register_handlers_with_message_handler
FAILED tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_no_profile
FAILED tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_exception
FAILED tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_language_callback_success
FAILED tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_language_callback_database_error
FAILED tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_birth_date_input_success
FAILED tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_birth_date_input_database_error
FAILED tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_life_expectancy_input_success
FAILED tests/test_bot/test_settings_handler.py::TestSettingsHandler::test_handle_life_expectancy_input_database_error
FAILED tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_success
FAILED tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_no_profile
FAILED tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_exception
FAILED tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_subscription_callback_same_subscription
FAILED tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_subscription_callback_successful_change
FAILED tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_subscription_callback_update_error
FAILED tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_subscription_callback_general_exception
FAILED tests/test_bot/test_subscription_handler.py::TestSubscriptionHandler::test_handle_subscription_callback_log_execution
FAILED tests/test_bot/test_weeks_handler.py::TestWeeksHandler::test_handle_not_registered
======================= 18 failed, 604 passed in 15.77s ========================
